<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>我的订单</title>
    <th:block th:include="common/base::proejct-context" th:remove="tag"></th:block>

</head>
<style>
    .r{
        color:red;
    }

    #waitOrder,
    #sendingOrder,
    #finishOrder,
    #canalOrder{
        font-size: 13px;
    }
</style>
<br>
<body>

<div class="bd-example bd-example-tabs">
    <div class="row">
        <div class="col-1">
            <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                <a class="nav-link  active show" id="v-pills-home-tab" data-toggle="pill" href="#v-pills-home" role="tab" aria-controls="v-pills-home" aria-selected="false">待接单</a>
                <a class="nav-link" id="v-pills-profile-tab" data-toggle="pill" href="#v-pills-profile" role="tab" aria-controls="v-pills-profile" aria-selected="false">正在送</a>
                <a class="nav-link" id="v-pills-messages-tab" data-toggle="pill" href="#v-pills-messages" role="tab" aria-controls="v-pills-messages" aria-selected="false">已完成</a>
                <a class="nav-link" id="v-pills-settings-tab" data-toggle="pill" href="#v-pills-settings" role="tab" aria-controls="v-pills-settings" aria-selected="true">已取消</a>
            </div>
        </div>
        <div class="col-11">
            <div class="tab-content" id="v-pills-tabContent">
                <div class="tab-pane fade  active show" id="v-pills-home" role="tabpanel" aria-labelledby="v-pills-home-tab">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                        <tr>
                            <th>订单号</th>
                            <th>下单时间</th>
                            <th>寄件地址</th>
                            <th>寄件人</th>
                            <th>寄件人手机</th>
                            <th>收件地址</th>
                            <th>收件人</th>
                            <th>收件人手机</th>
                            <th>详情</th>
                        </tr>
                        </thead>
                        <tbody id="waitOrder">

                        </tbody>
                    </table>
                </div>
                <div class="tab-pane fade" id="v-pills-profile" role="tabpanel" aria-labelledby="v-pills-profile-tab">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                        <tr>
                            <th>订单号</th>
                            <th>下单时间</th>
                            <th>寄件地址</th>
                            <th>寄件人</th>
                            <th>寄件人手机</th>
                            <th>收件地址</th>
                            <th>收件人</th>
                            <th>收件人手机</th>
                            <th>详情</th>
                        </tr>
                        </thead>
                        <tbody id="sendingOrder">

                        </tbody>
                    </table>
                </div>
                <div class="tab-pane fade" id="v-pills-messages" role="tabpanel" aria-labelledby="v-pills-messages-tab">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                        <tr>
                            <th>订单号</th>
                            <th>下单时间</th>
                            <th>寄件地址</th>
                            <th>寄件人</th>
                            <th>寄件人手机</th>
                            <th>收件地址</th>
                            <th>收件人</th>
                            <th>收件人手机</th>
                            <th>详情</th>
                        </tr>
                        </thead>
                        <tbody id="finishOrder">

                        </tbody>
                    </table>
                </div>
                <div class="tab-pane fade" id="v-pills-settings" role="tabpanel" aria-labelledby="v-pills-settings-tab">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                        <tr>
                            <th>订单号</th>
                            <th>下单时间</th>
                            <th>寄件地址</th>
                            <th>寄件人</th>
                            <th>寄件人手机</th>
                            <th>收件地址</th>
                            <th>收件人</th>
                            <th>收件人手机</th>
                            <th>详情</th>
                        </tr>
                        </thead>
                        <tbody id="canalOrder">

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


</body>

<script type="text/javascript" th:inline="javascript">

    $(function(){

        getAllMyOrder();

    })

    function getAllMyOrder(){
        $.ajax({
            type: "post",
            url:ctxPath+ "/myOrder/orderList",
            data: {},
            dataType: "json",
            success: function (result) {
                if(result.flag){
                    showOrder(result.result);
                }
                else{
                    alert(result.message);
                }
            },
            error: function (result) {
                console.log(result);
            }
        });
    }


    function showOrder(orderInfo){
        if(orderInfo!==null&&orderInfo!==""&&orderInfo!==undefined){
            var wait = "";
            var sending = "";
            var finish = "";
            var canal = "";
            for(let i = 0 ; i < orderInfo.length; i++){
                let oneOrder = orderInfo[i];
                /*var str = "订单信息---订单号："+oneOrder.orderNo+
                        "。 省份："+ oneOrder.orderCity+
                        "。 城市："+ oneOrder.orderPri+
                        "。 邮编："+ oneOrder.orderZip+
                        "。 寄件地址："+ oneOrder.startPos+
                        "。 寄件详细地址："+ oneOrder.startDetailPos+
                        "。 寄件人："+ oneOrder.sendName+
                        "。 寄件人手机："+ oneOrder.sendPhone+
                        "。 收件地址："+ oneOrder.endPos+
                        "。 收件详细地址："+ oneOrder.endDetailPos+
                        "。 收件人："+ oneOrder.reciveName+
                        "。 收件人手机："+ oneOrder.recivePhone +"</br>"*/
                var sendPhone = oneOrder.sendPhone===null?'':oneOrder.sendPhone;
                var str =
                    "<tr>" +
                        "<td>"+oneOrder.orderNo+"</td>"+
                        "<td>"+ getLocalTime(oneOrder.orderCreateTime)+"</td>"+
                        "<td>"+ oneOrder.startPos+"</td>"+
                        "<td>"+ oneOrder.sendName+"</td>"+
                        "<td>"+ sendPhone +"</td>"+
                        "<td>"+ oneOrder.endPos+"</td>"+
                        "<td>"+ oneOrder.reciveName+"</td>"+
                        "<td>"+ oneOrder.recivePhone +"</td>"+
                        "<td >详情</td>"+
                    "</tr>";

                if(oneOrder.orderStatus===10){
                    wait += str;
                }
                if(oneOrder.orderStatus===12){
                    sending += str;
                }
                if(oneOrder.orderStatus===16){
                    finish += str;
                }
                if(oneOrder.orderStatus===17){
                    canal += str;
                }
            }

            $("#waitOrder").append(wait);
            $("#sendingOrder").append(sending);
            $("#finishOrder").append(finish);
            $("#canalOrder").append(canal);
        }
    }


    function getLocalTime(nS) {
        return new Date(parseInt(nS) ).toLocaleString().replace(/:\d{1,2}$/,' ');
    }
</script>

</html>